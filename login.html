<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CyberMonitor Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>

<body class="min-h-screen flex items-center justify-center bg-black">
<div class="card p-6 w-96 text-white">

<h2 class="text-xl mb-4">Login</h2>

<input id="email" placeholder="Email"
       class="w-full p-2 mb-3 rounded bg-gray-900 border border-gray-700">

<input id="pass" type="password" placeholder="Password"
       class="w-full p-2 mb-3 rounded bg-gray-900 border border-gray-700">

<button onclick="login()" class="w-full bg-blue-600 p-2 rounded">
Login
</button>

<p id="err" class="text-xs text-red-400 mt-2"></p>

</div>
</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCIY6AiBsGrq7wM0BBYGW2lM_0FLWjnH0k",
  authDomain: "cybermonitor-1ab3c.firebaseapp.com",
  projectId: "cybermonitor-1ab3c",
});

const fs = firebase.firestore();

function login(){
 const em = document.getElementById("email").value.trim();
 const uid = em.replace(/@/g,"_").replace(/\./g,"_");

 fs.collection("users").doc(uid).get()
 .then(d=>{
    if(d.exists){
       localStorage.setItem("cm_user_email", em);
       location.href="dashboard.html";
    }else{
       err.innerText="User not registered";
    }
 });
}
</script>
</body>
</html>
